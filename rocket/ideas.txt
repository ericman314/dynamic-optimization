Objective Function

GEKKO can only do objective functions that are summed over the entire solution range. A trick for optimizing only the last point of a simulation is to multiply the objective function by an array for which only the last point is non-zero. Thus, you can solve an ODE where you specify the final condition.

For the rocket to touchdown smoothly at the landing zone, the state variables x, y, z, yaw, pitch, roll, x', y', z', yaw', pitch', and roll' must equal zero, with propellent greater than zero, at some point during the solution. We want to achieve that state at just one point in the solution, not the entire range, which means we can't just sum an objective function over the whole range. Nor can we just examine the last point in the solution, because we will not know a priori at what time the rocket will touchdown. GEKKO solutions have a fixed time domain, and touchdown probably will not occur at the last point in the solution. Whatever objective function we choose will be summed over the entire solution range, so we have to choose it carefully.

Let's assume that we wish to maximize the objective function. Some reference is needed to identify the point at which the state variables should be examined for an optimal solution. We can be sure that the rocket will either stop short of z = 0 or overshoot it (negative z). So let's choose z as the primary variable which will decide the point that will contribute to the objective function. This point would be when z = 0. Thus, we could include a term in the objective function, call it g(z), that has a peak at z = 0, which decreases quickly to zero for z > 0, and goes negative for z < 0. We also define a "closeness" term that is maximized when all state variables are zero. The objective function is the product of g(z) and the closeness term. Thus, if the rocket ever visits a point when z = 0 and all the other state variables are also zero, the objective function will be maximized since the closeness term will be a maximum when g(z) is also maximized. If the rocket stops short of z = 0, the objective function will be small since the point z = 0 is never included in the objective function summation. If the rocket overshoots z = 0, z' will be non-zero and g(z) will go negative, penalizing the objective. A key to ensuring a smooth landing will be to carefully choose the shape of g(z), which should heavily penalize excursions into the forbidden -z territory. The contribution of each state variable to the "closeness" term is also important. For example, pitch and roll are important whereas yaw doesn't matter (except to orient the logo towards the tracking cameras). x and y are important, but not as important as x', y', z, and z'.